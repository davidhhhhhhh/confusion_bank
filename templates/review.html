{% extends "base.html" %}

{% block title %}Review Mode - Confusion Bank{% endblock %}

{% block content %}
<div class="container">
    <h2>Review Mode</h2>
    <p>Get personalized review questions based on your actual confusion points from conversations.</p>

    <!-- Analysis Section - Top Priority -->
    <div id="analysis-section" class="review-section analysis-priority">
        <h3>üîç Analyze Past Conversations</h3>
        <div id="analysis-status" class="analysis-status">
            <p id="analysis-message">Checking if all your conversations have been analyzed...</p>
        </div>

        <button id="analyze-confusion" class="btn-secondary">
            <span id="analyze-text">Analyze My Confusion Points</span>
            <span id="analyze-loading" style="display: none;">Analyzing...</span>
        </button>

        <div id="analysis-results" class="analysis-feedback" style="display: none;"></div>
    </div>

    <div class="review-divider">
        <span>Choose your review method below</span>
    </div>

    <!-- Review Options Side by Side -->
    <div class="review-options-container">
        <!-- Natural Language Request -->
        <div id="natural-request-section" class="review-option">
            <h3>üéØ Quick Review Request</h3>
            <p>Tell us what you want to review in natural language:</p>

            <div class="form-group">
                <input type="text" id="natural-request" placeholder="e.g., 'I want to review neural networks' or 'help me with data mining concepts'" class="natural-input">
                <button id="generate-natural-review" class="btn-primary">Generate Review</button>
            </div>

            <div class="examples">
                <small>
                    <strong>Examples:</strong><br>
                    "I want to review deep learning"<br>
                    "Help me with neural networks"<br>
                    "Review data mining algorithms"
                </small>
            </div>
        </div>

        <!-- Traditional Course/Topic Selection -->
        <div id="traditional-selection" class="review-option">
            <h3>üìö Browse by Course & Topic</h3>
            <p>Select specific courses and topics that have confusion points:</p>

            <div class="form-group">
                <label for="course-select">Select Course:</label>
                <select id="course-select" name="course-select">
                    <option value="">Loading courses...</option>
                </select>
            </div>

            <div class="form-group">
                <label for="topic-select">Select Topic:</label>
                <select id="topic-select" name="topic-select" disabled>
                    <option value="">Select a course first</option>
                </select>
            </div>

            <button id="start-review" class="btn-primary" disabled>Start Review</button>
        </div>
    </div>

    <!-- Review Content Display -->
    <div id="review-content" style="display: none;">
        <div id="review-metadata">
            <div class="review-info">
                <h3 id="review-title"></h3>
                <p id="review-summary" class="summary"></p>
                <div id="review-stats" class="stats"></div>
            </div>
        </div>

        <div id="review-questions"></div>

        <div id="review-controls">
            <button id="prev-question" class="btn-secondary" disabled>Previous</button>
            <span id="question-counter">Question 1 of 7</span>
            <button id="next-question" class="btn-secondary">Next</button>
            <button id="end-review" class="btn-primary">End Review</button>
        </div>
    </div>

    <!-- Status messages -->
    <div id="review-status" class="status-message" style="display: none;"></div>
</div>
{% endblock %}